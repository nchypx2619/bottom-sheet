/*
 * Bottom Sheet
 * Version: 1.0
 * Author: nchypx2619
 * License: MIT
 * Description: Trigger all components to visible bottom-sheet on bottom in page. âœ¨ (https://github.com/nchypx2619/bottom-sheet)
 */
jQuery.fn.extend({bottomSheet:function(t){let e="bottomsheet";return this.each(function(o){this.dataset?.bottomSheet&&(e=this.dataset?.bottomSheet.replaceAll("#","")),this.id&&(e=`${this.id}-${e}`);let l=document.getElementById(e),d=!1;d=null!==l&&this.dataset?.bottomSheet,0===o?d||(e=null!==l?e+=l?.length??1:e):d=!0,l=document.getElementById(e);let i=document.getElementById(`${e}-toggle-btn`),n=null,s=null,a=null,h=null,c=!1,r=t=>t.touches||t.originalEvent.touches,m=t=>{let e=r(t)[0];n=e.clientY},u=t=>{h&&(h=a),null===h&&a&&(h=a),a=t.touches[0].clientY,h&&(c=h>a);let o=n-a;o>0||(document.querySelector(`#${e} .modal-dialog`).style.bottom=`${o}px`)},g=t=>{let o=document.querySelector(`#${e} .modal-dialog`)?.offsetTop;s=t.changedTouches[0].clientY,n&&s<o||c?document.querySelector(`#${e} .modal-dialog`).style.bottom="0px":(document.querySelector(`#${e} .modal-dialog`).style.bottom="-100%",setTimeout(()=>{$(`#${e}`).modal("hide")},100)),n=null,s=null,a=null,h=null,c=!1},v=()=>{$(l).modal("show")};if("object"==typeof t){if(t.content&&!d&&$(document.body).append(`<div class="modal sheet-bottom fade" id="${e}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><div id="${this.id}-${e}-toggle-btn" class="bottom-sheet-toggle-btn w-100 text-center" ><svg width="41" height="4" viewBox="0 0 41 4" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="0.5" width="40" height="4" rx="2" fill="#E2E3E5"/></svg></div></div><div class="modal-body">${t.content}</div></div></div></div>`),!d){function b(t){let o=document.querySelector(`#${e} .modal-dialog`)?.offsetTop,l=t.touches[0]?.clientY??t.originalEvent.touches[0]?.clientY;if(l>o)return!1;g(t)}null===l&&(l=document.getElementById(e)),l.addEventListener("shown.bs.modal",function(){document.querySelector(`#${e} .modal-dialog`).style.bottom="0px"}),l.addEventListener("touchstart",b),null===i&&(i=document.getElementById(`${this.id}-${e}-toggle-btn`)),i.addEventListener("touchstart",m),i.addEventListener("touchmove",u),i.addEventListener("touchend",g)}this.setAttribute("data-bottom-sheet",`#${e}`),$(this).on("click.toggle-bottom-sheet",v),t.actived&&v()}else"string"==typeof t&&"destroy"===t&&(this.removeAttribute("data-bottom-sheet"),$(this).off("click.toggle-bottom-sheet"),d&&(l.removeEventListener("touchstart",b),i.removeEventListener("touchstart",m),i.removeEventListener("touchmove",u),i.removeEventListener("touchend",g),$(l).modal("hide"),document.getElementById(e).remove()))})}});
